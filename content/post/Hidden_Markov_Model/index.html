---
title: "Hidden Markov Model"
author: "Cara Yijin Zou"
date: "2020-04-20"
output: html_document
math : true
categories: ["Statistics", "Probability","Bioinformatics"]
tags: ["Statistics","Modelling", "Markov Chain","Probability","HMM","Forward Algorithm","Viterbi Algorithm", "Emission probability","Observed State","R"]
draft: false
image:
  placement: 1
  caption: "Hidden Markov Model Example"
  focal_point: "Center"
  preview_only: true
  
---



<div id="hidden-markov-model" class="section level1">
<h1>Hidden Markov Model</h1>
<p>I go over the basics of a Markov Chain <a href="../Markov_chain">here</a>, however, unlike chutes and ladders, for a hidden markov model, there is hidden information. In this case the markov chain is not visible to us, we can only observe outcome values.</p>
<p>Like a markov chain, there are still <strong>states</strong> (now hidden), <strong>transition probabilities</strong>, and <strong>initial probabilities</strong>. However, in addition to this, we also have an <strong>observed state</strong> and an <strong>emission probability</strong>.</p>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="751px" viewBox="-0.5 -0.5 751 441" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2020-07-02T17:47:17.085Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36&quot; etag=&quot;IwPpH-5e6uUfPe3D6aqo&quot; version=&quot;13.3.5&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;C5RBs43oDa-KdzZeNtuy&quot; name=&quot;Page-1&quot;&gt;7Vxbk5pIFP41PsaiLyA+RjMz2c1uNrtmd3aeUkRapQZtt8FR8+u3GRqB7lbQEdBgpSpFX2joc/nOdw7tdNBwvnlgznL2O3WJ34GGu+mgDx0I+9ji/0cd27jDBHbcMWWeG3eBtGPk/SCi0xC9K88lQW5iSKkfest855guFmQc5vocxug6P21C/fxTl86UKB2jseOrvY+eG87iXhv20v6PxJvOkicDqx+PzJ1ksthJMHNcus50obsOGjJKw/hqvhkSP5JdIpfHX7aP/m/P1sOvfwb/OX8PPn39/M+7eLH7Y27ZbYGRRXjepYUUXhx/JeT1mYQT39uILYfbRI6MrhYuidYCHTRYz7yQjJbOOBpdc8PhfbNw7ovhCV2EwhQAl9Ng6jtBpEeDXwcho887XUSzd4KNhiee7w+pT9nrY9Hg9R/vLykDIasXwkKyyViAkMkDoXMSsi2fIkZxX6hX2DfEor1OrQUkJjDLWEoyzxEGOt0tnSqBXwg9HKNuoChl5BOybI1KwOWpBCoq+ciXXlP23BqtIJzXCurVqBUU3OHFwJzNBi8j9unr9psz+UPgXVYpijLIwn0fBRHeGkei9cZ5+XMZse2/kUS7ZtJ8yo592Ahxx61t0tp4YeY23nrKjKQ3RY3knvjliKvEq3KaCuiKjUkJIw0dNiWHFuzp9ZzRo6lRY9LHiO+E3kt+Ezrdiid8oR7fXmpGknMjUzKPeJ/irmw8kxbCsj0a0kKxHJSFXk1tt+3TrU9FaaOLFQPkzhXmTS5268RzF3RBJGcWXY7vTReR3XLrILx/ELmqx4nNezEw91w3eowWY1IUSk1P8fWyxrc/eO7TQcaWsMaWYFWQoOJ0bZDwRvcu9FqwRxX1uC029qD/tbkturktRPDC3BYXu+14xV52rKrIh9/ki025mIn20N5jXczsSQuhci7GRepsM9OW0YTgwAsD6TnAOPxe0gaBXTDfOnK+Lb2PkZvPL+IdnhVPTA2emC3DEyjhCTAbxhPrDDRAMPzk+inH9vUMP6UOWeKQ4RHVUIfizKAsx7hlBueABLWoZnQTVbUFElAP57FYUy2oFRLsG8VQgfpkigGteigGNI6jGEokKqAMO8GWnS9TqzooRv980czowmzBCpQMZ+KuXUS7lngWl8QaC2gSH0XgRG9DkpUiq96Apil/ty9pliEPoYYjGtCVMqyWaUXJKZtOPUCJWsYRJUg7j7zvjK5RlE28tr4Q5vENRWqrpzrZKNIqmb+NTkNaU+YbcpmzaqTVlRPaljvISmgeaUvUE37+5AHZZk4t+FQ6gyXMxrLizpQ8IImsJ3WBvTRL3mDv8HwMj5yPD75PNckD0FUjVPP9uRFFLi1hu2lEKVGOKJ3T5SqUsGSJEnRyJUrYdI2yV5ZoNIuBco2yfyoGyjVKuRJTNdFQiwpGF7UNFmTaCBuGhWTh7NG/kJEg4KKQVcNmdP59FewRYPaMWf6gWL8/HN7fVynV4ozM1gjVrkyo6kmdvzgKbK5YplATv+qVqVoRqid+5eGnE33bMYyM6OstOh5w4kuJUAq5PjlC1ZwKQ7W8dbyJ6dlOUQFFa5i96zfMRqkTKGI8ZQ1TOR4uc7CqDVOtBlxfkO4Zlxal1Tz16qK0LNTmw/QZ0szKgK0Yr6wm8cqST7fJH93K4pUlfyuX62ZV49UZvh/vNwL9OamCYLnnoNTllSAOQNWN4L31JLaa7FZgl0YX9GH2yEPXKCqR8caZP5+V/O3O1ZsUkgKgWTPUITXVr8SkbNPOm9TNoiqyKPlbYO0WpWah10f25aMrOyE2xUuRekji6sg+vjihqmT/cs8OUD7ohZHozCor/LsfJEvnNRur8CPdd5d+y5UkV7f7DSsJq8z0cj+O1aQkS8oWoAbu6lWS7gfYvZYr6eI8Cd7gTmFjMjdu+sgq1h0kbjlxwHZtSuLN9I9IxXlL+pe40N3/&lt;/diagram&gt;&lt;/mxfile&gt;" onclick="(function(svg){var src=window.event.target||window.event.srcElement;while (src!=null&amp;&amp;src.nodeName.toLowerCase()!='a'){src=src.parentNode;}if(src==null){if(svg.wnd!=null&amp;&amp;!svg.wnd.closed){svg.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&amp;&amp;evt.source==svg.wnd){svg.wnd.postMessage(decodeURIComponent(svg.getAttribute('content')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);svg.wnd=window.open('https://app.diagrams.net/?client=1&amp;lightbox=1&amp;edit=_blank');}}})(this);" style="cursor:pointer;max-width:100%;max-height:441px;">
<defs/><g><rect x="460" y="90" width="120" height="40" rx="6" ry="6" fill="#b3b3b3" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 110px; margin-left: 461px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
Netflix
</div>
</div>
</div>
</foreignObject><text x="520" y="114" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Netflix</text>
</switch>
</g><rect x="160" y="90" width="120" height="40" rx="6" ry="6" fill="#b3b3b3" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 110px; margin-left: 161px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
Sleep
</div>
</div>
</div>
</foreignObject><text x="220" y="114" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Sleep</text>
</switch>
</g><rect x="310" y="220" width="120" height="40" rx="6" ry="6" fill="#b3b3b3" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 240px; margin-left: 311px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
Homework
</div>
</div>
</div>
</foreignObject><text x="370" y="244" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Homework</text>
</switch>
</g><path d="M 370 220 L 514.54 133.28" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 519.04 130.58 L 514.84 137.18 L 514.54 133.28 L 511.24 131.18 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="410" y="150" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 160px; margin-left: 411px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.4
</div>
</div>
</div>
</foreignObject><text x="430" y="164" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.4</text>
</switch>
</g><path d="M 370 220 L 225.46 133.28" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 220.96 130.58 L 228.76 131.18 L 225.46 133.28 L 225.16 137.18 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="290" y="150" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 160px; margin-left: 291px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.4
</div>
</div>
</div>
</foreignObject><text x="310" y="164" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.4</text>
</switch>
</g><path d="M 500 90 Q 480 60 490 45 Q 500 30 515 30 Q 530 30 540 40 Q 550 50 542.01 73.96" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 540.35 78.94 L 539.25 71.19 L 542.01 73.96 L 545.89 73.41 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="190" y="0" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 10px; margin-left: 191px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.5
</div>
</div>
</div>
</foreignObject><text x="210" y="14" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.5</text>
</switch>
</g><path d="M 280 110 L 453.63 110" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 458.88 110 L 451.88 113.5 L 453.63 110 L 451.88 106.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="344" y="120" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 130px; margin-left: 345px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.1
</div>
</div>
</div>
</foreignObject><text x="364" y="134" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.1</text>
</switch>
</g><path d="M 190 90 Q 170 60 180 45 Q 190 30 205 30 Q 220 30 230 40 Q 240 50 232.01 73.96" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 230.35 78.94 L 229.25 71.19 L 232.01 73.96 L 235.89 73.41 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 190 130 L 334.54 216.72" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 339.04 219.42 L 331.24 218.82 L 334.54 216.72 L 334.84 212.82 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="230" y="180" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 190px; margin-left: 231px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.4
</div>
</div>
</div>
</foreignObject><text x="250" y="194" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.4</text>
</switch>
</g><rect x="500" y="0" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 10px; margin-left: 501px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.6
</div>
</div>
</div>
</foreignObject><text x="520" y="14" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.6</text>
</switch>
</g><path d="M 550 133 L 414.45 214.71" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 409.96 217.42 L 414.15 210.81 L 414.45 214.71 L 417.76 216.81 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="470" y="180" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 190px; margin-left: 471px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.1
</div>
</div>
</div>
</foreignObject><text x="490" y="194" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.1</text>
</switch>
</g><path d="M 355 260 Q 340 290 347.5 305 Q 355 320 375 320 Q 395 320 402.5 305 Q 410 290 402.85 275.7" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 400.5 271 L 406.76 275.7 L 402.85 275.7 L 400.5 278.83 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="360" y="330" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 340px; margin-left: 361px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.2
</div>
</div>
</div>
</foreignObject><text x="380" y="344" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.2</text>
</switch>
</g><path d="M 460 100 L 286.37 100" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 281.12 100 L 288.12 96.5 L 286.37 100 L 288.12 103.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="350" y="70" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 80px; margin-left: 351px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.3
</div>
</div>
</div>
</foreignObject><text x="370" y="84" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.3</text>
</switch>
</g><path d="M 40 0 L 80 40 L 40 80 L 0 40 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 40px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
Stressed
</div>
</div>
</div>
</foreignObject><text x="40" y="44" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Stressed</text>
</switch>
</g><path d="M 40 130 L 80 170 L 40 210 L 0 170 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 170px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
Relaxed
</div>
</div>
</div>
</foreignObject><text x="40" y="174" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Relaxed</text>
</switch>
</g><path d="M 160 100 L 72.36 56.18" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 67.67 53.83 L 75.49 53.83 L 72.36 56.18 L 72.36 60.09 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 160 120 L 66.1 148.17" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 61.07 149.68 L 66.77 144.31 L 66.1 148.17 L 68.78 151.02 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 710 0 L 750 40 L 710 80 L 670 40 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 40px; margin-left: 671px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
Stressed
</div>
</div>
</div>
</foreignObject><text x="710" y="44" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Stressed</text>
</switch>
</g><path d="M 710 130 L 750 170 L 710 210 L 670 170 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 170px; margin-left: 671px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
Relaxed
</div>
</div>
</div>
</foreignObject><text x="710" y="174" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Relaxed</text>
</switch>
</g><path d="M 580 110 L 678.39 57.02" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 683.02 54.53 L 678.51 60.93 L 678.39 57.02 L 675.19 54.77 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 580 120 L 683.86 148.32" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 688.92 149.71 L 681.25 151.24 L 683.86 148.32 L 683.09 144.49 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 333.04 261 L 273.42 354.63" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 270.6 359.06 L 271.41 351.27 L 273.42 354.63 L 277.31 355.03 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 412.96 262 L 466.8 354.5" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 469.44 359.03 L 462.89 354.74 L 466.8 354.5 L 468.94 351.22 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 270 360 L 310 400 L 270 440 L 230 400 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 400px; margin-left: 231px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
Stressed
</div>
</div>
</div>
</foreignObject><text x="270" y="404" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Stressed</text>
</switch>
</g><path d="M 470 360 L 510 400 L 470 440 L 430 400 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 400px; margin-left: 431px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
Relaxed
</div>
</div>
</div>
</foreignObject><text x="470" y="404" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Relaxed</text>
</switch>
</g><rect x="90" y="50" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 60px; margin-left: 91px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.1
</div>
</div>
</div>
</foreignObject><text x="110" y="64" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.1</text>
</switch>
</g><rect x="100" y="140" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 150px; margin-left: 101px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.9
</div>
</div>
</div>
</foreignObject><text x="120" y="154" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.9</text>
</switch>
</g><rect x="610" y="60" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 70px; margin-left: 611px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.3
</div>
</div>
</div>
</foreignObject><text x="630" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.3</text>
</switch>
</g><rect x="600" y="140" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 150px; margin-left: 601px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.7
</div>
</div>
</div>
</foreignObject><text x="620" y="154" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.7</text>
</switch>
</g><rect x="260" y="300" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 310px; margin-left: 261px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.9
</div>
</div>
</div>
</foreignObject><text x="280" y="314" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.9</text>
</switch>
</g><rect x="450" y="300" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 310px; margin-left: 451px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
0.1
</div>
</div>
</div>
</foreignObject><text x="470" y="314" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.1</text>
</switch>
</g></g>
<switch>
<g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a>
</switch>
</svg>
</div>
<div id="emission-probability" class="section level1">
<h1>Emission probability</h1>
<p>The <strong>emission probability</strong> is what gives way to the <strong>observed state</strong>. In other words, given the state <span class="math inline">\(\pi\)</span>, what is the probability of the observed state <span class="math inline">\(x\)</span> happening at time <span class="math inline">\(i\)</span>.</p>
<p><span class="math display">\[
P (x_{i}|\pi_{i}) = \textrm{emission probability}
\]</span></p>
<p>Still using the example from before, the difference now is that you don’t know if the student is sleeping, watching netflix, or doing homework. Instead, the only information you have is whether or not the student is stressed (observed state). Depending on your actual state (sleep, homework, netflix), the probability of being stressed changes.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Relaxed</th>
<th>Stressed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Sleep</strong></td>
<td>0.9</td>
<td>0.1</td>
</tr>
<tr class="even">
<td><strong>Homework</strong></td>
<td>0.1</td>
<td>0.9</td>
</tr>
<tr class="odd">
<td><strong>Netflix</strong></td>
<td>0.7</td>
<td>0.3</td>
</tr>
</tbody>
</table>
<p>For reference, here is the <strong>initial probabilities</strong> from before:</p>
<table>
<thead>
<tr class="header">
<th>Outcome</th>
<th>Likelihood</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sleep</td>
<td>0.6</td>
</tr>
<tr class="even">
<td>Homework</td>
<td>0.3</td>
</tr>
<tr class="odd">
<td>Netflix</td>
<td>0.1</td>
</tr>
</tbody>
</table>
<p>As well as the <strong>transition probabilities</strong>:
<em>Keep in mind:</em> <span class="math inline">\(P (\pi_{i-1} \rightarrow \pi_{i})\)</span> and <span class="math inline">\(P(\pi_{i}|\pi_{i-1})\)</span></p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Sleep</th>
<th>Homework</th>
<th>Netflix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Sleep</strong></td>
<td>0.5</td>
<td>0.4</td>
<td>0.1</td>
</tr>
<tr class="even">
<td><strong>Homework</strong></td>
<td>0.4</td>
<td>0.2</td>
<td>0.4</td>
</tr>
<tr class="odd">
<td><strong>Netflix</strong></td>
<td>0.3</td>
<td>0.1</td>
<td>0.6</td>
</tr>
</tbody>
</table>
<div id="example" class="section level2">
<h2>Example</h2>
<table style="width:100%;">
<colgroup>
<col width="58%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th>Observations <span class="math inline">\(x\)</span> (1= stressed, 0=relaxed)</th>
<th>1</th>
<th>1</th>
<th>0</th>
<th>0</th>
<th>1</th>
<th>1</th>
<th>1</th>
<th>0</th>
<th>0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>State Path</strong> <span class="math inline">\(\pi\)</span> (S= sleep, H=homework, N=netflix)</td>
<td>H</td>
<td>H</td>
<td>N</td>
<td>N</td>
<td>N</td>
<td>H</td>
<td>S</td>
<td>S</td>
<td>S</td>
</tr>
<tr class="even">
<td><strong>Emission Probability</strong> <span class="math inline">\(P (x_{i}|\pi_{i})\)</span></td>
<td>0.9</td>
<td>0.9</td>
<td>0.7</td>
<td>0.7</td>
<td>0.3</td>
<td>0.9</td>
<td>0.1</td>
<td>0.9</td>
<td>0.9</td>
</tr>
<tr class="odd">
<td><strong>Transition Probability</strong> <span class="math inline">\(P (\pi_{i-1} \rightarrow \pi_{i})\)</span></td>
<td>0.3</td>
<td>0.2</td>
<td>0.4</td>
<td>0.6</td>
<td>0.6</td>
<td>0.1</td>
<td>0.4</td>
<td>0.5</td>
<td>0.5</td>
</tr>
</tbody>
</table>
</div>
<div id="what-is-the-likelihood-of-a-specific-observation-sequence" class="section level2">
<h2>What is the <strong>likelihood</strong> of a specific observation sequence?</h2>
<p><span class="math display">\[
P (x)= \sum_{\pi} P(x \textrm{ and }\pi)
\]</span></p>
<p>What the above equation describes is that to determine the likelihood of an observation sequence, you must <strong>add</strong> the probabilities of the observed sequence and the potential (hidden) state paths occurring. So how do we do this???</p>
<p>Based on conditional probability:</p>
<p><span class="math display">\[
P(x \textrm{ and } \pi) = P (x | \pi) \cdot P(\pi)
\]</span></p>
<p>Multiply the emission probabilities together:
<em>Given a state sequence, what is the probability of emitting the observed sequence.</em>
<span class="math display">\[
P (x | \pi) = \prod_{t=1} P (x_{t}|\pi_{t})
\]</span>
Multiply the transition probabilities together:
<em>Probabililty of a state sequence depends on the <strong>markov property</strong> that the state at time t is only dependent on the state at t-1. </em></p>
<p><span class="math display">\[
P(\pi) = \prod_{t=1} P (\pi_{t}|\pi_{t-1})
\]</span></p>
<p>Putting it all together:
<em>The probability of an observed sequence and a corresponding hidden state sequence is equal to the product of the emission probabilities multiplied by the product of the transition probabilities.</em></p>
<p><span class="math display">\[
P(\pi \textrm{ and } x) =  \prod_{t=1} P (\pi_{t}|x_{t}) \cdot \prod_{t=1} P (\pi_{t}|\pi_{t-1})
\]</span>
As an example:</p>
<p>We could potentially state all possible state paths given a particular observations. If we observed: {1, 0, 0}, the possible state paths include SSS, SHH, SHN, SNN, SNH, HHH, HNS, HSH, HSS, etc. We could calculate the possibility of each, for example: SNS. Initial probability of sleep is 0.6. The probability of being stressed given that they are sleeping is 0.1. Sleep transitioning to Netflix is 0.1.Probability of being relaxed watching Netflix is 0.3. And so on…</p>
<p><span class="math display">\[
P (\pi_{1}=S | \textrm{start}) \cdot P(x_{1}=1|\pi_{1}=S)\cdot P ( \pi_{2}=N | \pi_{1}=S )\cdot P(x_{1}=0|\pi_{1}=N)\cdot P (\pi_{3}=S|\pi_{2}=N)\cdot P(x_{3}=0|\pi_{3}=S)
\]</span>
<span class="math display">\[
P (\pi=\textrm{S N S} \cap x=\textrm{1 0 0})=0.6 \cdot0.1\cdot0.1\cdot0.3\cdot0.3\cdot0.9 = 0.000486
\]</span></p>
<p>To find the <strong>total probability</strong> of an observed sequence (e.g. 1,0,0), we need to <strong>add</strong> up all of the possible state path probabilities (SNS, SSS, HSN, etc.).</p>
<p><span class="math display">\[
P(\textrm{1 0 0}) = P(\textrm{1 0 0}| \textrm{S N S})+P(\textrm{1 0 0}| \textrm{N N S}) +P(\textrm{1 0 0}| \textrm{S N H}) + ...
\]</span>
However, what if the observation sequence is long and therefore the corresponding hidden state sequence is also long which many possible permutations. Calculating the likelihood of a observation would take forever… which is why we use the <strong>forward algorithm</strong>.</p>
</div>
<div id="forward-algorithm" class="section level2">
<h2>Forward algorithm</h2>
<p>The forward algorithm uses <strong>dynamic programming</strong>. What this means is that the problem is broken down into sub-problems which you find the optimal solution to in order to solve the larger problem. The solutions from the sub-problem are stored (memoization) so that you don’t waste time computing it over and over again.</p>
<ol style="list-style-type: decimal">
<li><p>To implement this, you need to create an empty matrix to <strong>store intermediate values</strong>. The rows equal the number of states (in this case, 3), while the columns should be equal to the number of values in the observation sequence.</p></li>
<li><p>First column: The first column states the probability of each state being the initial state and emitting the first observation. All future calculations will be based on these values.</p></li>
<li><p>Subsequent columns: Each value in the matrix represents the likelihood of being in a certain state <em>k</em> having observed the first <em>i</em> values in the observation sequence. We will represent this by:</p></li>
</ol>
<p><span class="math display">\[
P (\pi_t=k \textrm{ and } x = x_1, x_2 , x_3 , ...x_t) = \alpha_t (k)
\]</span>
This is calculated by taking the emission probability of emitting <span class="math inline">\(x_t\)</span> given that we are at state <em>k</em> and multiplying this by the summation of the probabilities of being at the previous state <span class="math inline">\(l\)</span> at <em>t-1</em> and transitioning to state <em>k</em>.</p>
<p><span class="math display">\[
\alpha_t (k) = \textrm{(emission probability of } x_{t} \textrm{ given current state k)}\sum \alpha_{t-1} (l) \cdot \textrm{(transition probability from l to k)}
\]</span>
<span class="math display">\[
\alpha_t (k) = P (x_{t}|\pi_{t})\sum \alpha_{t-1} (l) \cdot P (\pi_{t}|\pi_{t-1})
\]</span>
OK, that’s just a ton of math, what does it actually mean? Still using the example from before with the observed sequence 1 0 0, if we have already calculated all the paths from 1 0, we then need to calculate the path to the next 0 based on these paths formed from 1 0. Therefore for each value, you must look at the values in the previous columns.</p>
<pre class="python"><code>def forward():
  # if Stressed = 0, Relaxed = 1
  observations = [1, 0, 0, 1, 1, 0, 1, 1]
  #build empty dynamic programming matrix 
  num_states= 3
  obs_seq_num = len (observations)
  grid = []
  for j in range(num_states):  
    grid.append(obs_seq_num * [0])
        
    
  # initial probability distribution for S, H, N
  initial = [0.6,0.3,0.1]
  
  # emission probability 
  emission= [[0.9,0.1],[0.1,0.9],[0.7,0.3]]
        
  #transition probabilities 
  transition = [[0.5,0.4,0.1],[0.4,0.2,0.4],[0.3,0.1,0.6]]

  #Start filling out the grid
  for t in range(obs_seq_num):
    for i in range(num_states):
      #first column 
      if t == 0: 
        # use the initial probability distribution 
        grid[i][t] = initial[i] * emission [i][observations[t]]
      else: 
        grid[i][t] = emission [i][observations[t]] * ((grid[0][t-1]*transition[0][i]) + (grid[1][t-1]*transition[1][i]) + (grid[2][t-1]*transition[2][i]))
  
  prettyPrint (grid)
  
  print (&quot;Probability of observing: &quot;)
  for k in observations:
    print (observations[k], end=&quot;        &quot;)
  print ()
  
  for s in range(obs_seq_num): 
    sum=0
    for q in range (num_states):
      sum+=grid[q][s]
    print (format(sum, &quot;5.4f&quot;), end = &quot;   &quot;)
forward()</code></pre>
<pre><code>##          0          1          2          3          4          5          6          7 
## S  0.0600000  0.1323000  0.0873990  0.0061352  0.0021659  0.0064380  0.0005115  0.0001805  
## H  0.2700000  0.0081000  0.0063780  0.0371420  0.0100145  0.0003557  0.0029078  0.0008235  
## N  0.0300000  0.0924000  0.0503370  0.0124480  0.0068817  0.0058460  0.0012881  0.0005961  
## 
## Probability of observing: 
## 0        1        1        0        0        1        0        0        
## 0.3600   0.2328   0.1441   0.0557   0.0191   0.0126   0.0047   0.0016</code></pre>
<p>For example, how did we calculate the probability of being at state S at time 2 with the observations thus far being: 1 0.</p>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="403px" viewBox="-0.5 -0.5 403 324" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2020-07-06T20:03:18.271Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36&quot; etag=&quot;DsuH0lr6Z-pgRyVUjwq8&quot; version=&quot;13.3.9&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;1_E2bteAL8cD-64oW33z&quot; name=&quot;Page-1&quot;&gt;7Vxdd6I4GP41Xm4PAUG9nNo6vejM7lkvdnqZlVRzBokTYtX59ZtAECUggQVBak9PD3mBAO/zvJ+EDqzpev+Vws3qG3GRNzANdz+wngamORk6/K8QHCKBDcaRYEmxG4lAIpjj30gKDSndYhcFZwcyQjyGN+fCBfF9tGBnMkgp2Z0f9k6886tu4BIpgvkCeqr0H+yylZQCZ5LseEF4uZKXHpvygdcwPlg+SbCCLtmdiKzngTWlhLBoa72fIk/oLtZLdN4sZ+/xxijymc4J31+Xz8avX+Zk/fb68vantVvNrT/kLB/Q28oHnhG6g9Tlwm+QUbyXN88OsUb4c2zEJoP/CtHjYoU99xUeyJbF0nj0yPX/iv0QP0McSrzt2j+VBAxSJlEfCsGKrT2+DfjmboUZmm/gQuzccXZFM3hwE+Dw0uEMFC22NMAf6G8URPMIKdpvoO/KwYZgnyH6/ME1FV/4nfhsLh9KXAx6eOnz7QUSh4o7i+ESe6WWEGVon6t+cASVGwMia8TogR8iTzDHkgfSEEZyuEtYNTSkbHVCKCvmD5RMXh6nTsDmGxLvEtibCvYq1ju89qAvYF4Rin9zpUHvVKvhPdmP/Jff5dR4sAc2P2/KxyAZ819xOGVT4geMQhxqDMGA7VDAusMCHZDzrUhF/hDDqoc0aAxpS0Ga4TXiknBggEu4S8cKE123hlZ1gMyLppkB0BGL6wAEJgpCxoPhKLjwB2fnCuf2RH6iKfEId1pPPgkxe8eelxIp/k2oEfM490XuWGPXDf15FoSUbH0XxdiUd435rMwFxdJwlypEjSE0VAC66C0/gdUAp3WzsUbFIQz57heRBwruezAI8OJc9yIExLYy4KwLf7iccDgwE+yzDMXO+IGOM50aiX6Rq+SRBdodZmv3RJt2hjJjGUUeZJwL5wlvhoLlFf4SzEjASyUj4xRCAdnSBZLnnOaUqWmAfXkezvklYso8IdjHZ/4fGYyawhgPwDKtfjvOHOakollHHKetQKSi87kc59FK2nOcpooKzzfGo2G/Dce+JcNximNb38uz6khfrsiyUpfMkiwdz2oDVyNx0XaKt4GIo2V7RS6xMUDii515RHPUb384uohJqgKzWvaH47vJVKu/mrMZta/EswhjrPaTemU14zJZRNtWozaWPrfVaCffzVmNmtgJq3F6nntPbslqLNWzKehUbSyhPWY/5DFi+03omWfi0ehpf7QQPjjEA58/1Y/TQXTWyI7HyXnhKD6xqIs1m8m7GlTsYsU96rBhpJFfRR2hwqDSVl8MpBpjTophuo2xdPIEUvM03BgDajZ7ye3fi8cSxaP2+7zGIghQ39r3PagDIxuTzpSPKiQ8qPe8Dw0ur3joWP0IzLvVdK6CVF+rcrOZmD3PhSMq3koyDDSS4c9lOB0oItUGMjccu/cR5/KakY4ZjqWRhRdVkfVVi6CgVBxUrADjbl9hBRgv3y2sAHO8YzsVoEKPyiXgKDVRwzWgpVElVGPfqFqzovVehS5T49V4N9aruF2mqllgaaY2320r8p+doa++o73Ttxb6ahSWjThahWKCYLNZvgsux+DuuNlWl0rWxlMwSU105dWSQHWzc4WoHSwXyn+kUe5LHND2Si+grsZ7uQNjJm9fWgNGXXPy/Q4MD7iZr0CuCIypsRioicpaIySWi35tBbWhkzK1ScWgNhylnGl6oqY/AdBY4NJxJpx8DdwnJpjGldNwNYqWZkKdVWR+dl4+z/7kVLLsK1NJY+19EZXy4a+TZA1SKScluHUqpVf0NE2lGjKV/G8PNT9ezGaWeb0I12qjyU71hyp/7WinC/hrR7gacp2GuFTQqaqTS602g2rzS46Rmqi2FYJ8mPxTmejw5D/zWM//AQ==&lt;/diagram&gt;&lt;/mxfile&gt;" onclick="(function(svg){var src=window.event.target||window.event.srcElement;while (src!=null&amp;&amp;src.nodeName.toLowerCase()!='a'){src=src.parentNode;}if(src==null){if(svg.wnd!=null&amp;&amp;!svg.wnd.closed){svg.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&amp;&amp;evt.source==svg.wnd){svg.wnd.postMessage(decodeURIComponent(svg.getAttribute('content')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);svg.wnd=window.open('https://app.diagrams.net/?client=1&amp;lightbox=1&amp;edit=_blank');}}})(this);" style="cursor:pointer;max-width:100%;max-height:324px;">
<defs/><g><path d="M 0 40 L 0 0 L 400 0 L 400 40" fill="#000000" stroke="#000000" stroke-miterlimit="10" transform="translate(2,3)" opacity="0.25"/><path d="M 0 40 L 0 0 L 400 0 L 400 40" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 0 40 L 0 320 L 400 320 L 400 40" fill="none" stroke="#000000" stroke-miterlimit="10" transform="translate(2,3)" opacity="0.25"/><path d="M 0 40 L 0 320 L 400 320 L 400 40" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 0 40 L 400 40" fill="none" stroke="#000000" stroke-miterlimit="10" transform="translate(2,3)" opacity="0.25"/><path d="M 0 40 L 400 40" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 398px; height: 1px; padding-top: 20px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
Forward Matrix
</div>
</div>
</div>
</foreignObject><text x="200" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Forward Matrix</text>
</switch>
</g><path d="M 40 40 L 0 40 L 0 160 L 40 160" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 40 L 400 40 L 400 160 L 40 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 40 L 40 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 80 L 40 40 L 160 40 L 160 80" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 80 L 40 160 L 160 160 L 160 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 80 L 160 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 60px; margin-left: 41px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
time = 1
</div>
</div>
</div>
</foreignObject><text x="100" y="64" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">time = 1</text>
</switch>
</g><rect x="70" y="110" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 71px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.06
</div>
</div>
</div>
</foreignObject><text x="90" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.06</text>
</switch>
</g><path d="M 160 80 L 160 40 L 280 40 L 280 80" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 80 L 160 160 L 280 160 L 280 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 80 L 280 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 60px; margin-left: 161px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
2
</div>
</div>
</div>
</foreignObject><text x="220" y="64" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">2</text>
</switch>
</g><path d="M 240 120 L 303.63 120" fill="none" stroke="#66cc00" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 308.88 120 L 301.88 123.5 L 303.63 120 L 301.88 116.5 Z" fill-opacity="0.3" fill="#66cc00" stroke="#66cc00" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><rect x="200" y="110" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 201px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.1323
</div>
</div>
</div>
</foreignObject><text x="220" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.1323</text>
</switch>
</g><path d="M 280 80 L 280 40 L 400 40 L 400 80" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 80 L 280 160 L 400 160 L 400 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 80 L 400 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 60px; margin-left: 281px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
3
</div>
</div>
</div>
</foreignObject><text x="340" y="64" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">3</text>
</switch>
</g><rect x="320" y="110" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 321px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0874
</div>
</div>
</div>
</foreignObject><text x="340" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0874</text>
</switch>
</g><path d="M 40 160 L 0 160 L 0 240 L 40 240" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 160 L 400 160 L 400 240 L 40 240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 160 L 40 240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 160 L 40 160 L 160 160 L 160 160" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 160 L 40 240 L 160 240 L 160 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 160 L 160 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="70" y="190" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 200px; margin-left: 71px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.27
</div>
</div>
</div>
</foreignObject><text x="90" y="204" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.27</text>
</switch>
</g><path d="M 160 160 L 160 160 L 280 160 L 280 160" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 160 L 160 240 L 280 240 L 280 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 160 L 280 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="200" y="190" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 200px; margin-left: 201px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0081
</div>
</div>
</div>
</foreignObject><text x="220" y="204" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0081</text>
</switch>
</g><path d="M 280 160 L 280 160 L 400 160 L 400 160" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 160 L 280 240 L 400 240 L 400 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 160 L 400 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="320" y="190" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 200px; margin-left: 321px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0064
</div>
</div>
</div>
</foreignObject><text x="340" y="204" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0064</text>
</switch>
</g><path d="M 110 200 L 193.64 204.65" fill="none" stroke="#ff0000" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 198.88 204.94 L 191.7 208.04 L 193.64 204.65 L 192.09 201.06 Z" fill-opacity="0.3" fill="#ff0000" stroke="#ff0000" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 240 L 0 240 L 0 320 L 40 320" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 240 L 400 240 L 400 320 L 40 320" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 240 L 40 320" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 240 L 40 240 L 160 240 L 160 240" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 240 L 40 320 L 160 320 L 160 240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 240 L 160 240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="70" y="270" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 280px; margin-left: 71px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.03
</div>
</div>
</div>
</foreignObject><text x="90" y="284" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.03</text>
</switch>
</g><path d="M 160 240 L 160 240 L 280 240 L 280 240" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 240 L 160 320 L 280 320 L 280 240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 240 L 280 240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="200" y="270" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 280px; margin-left: 201px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0924
</div>
</div>
</div>
</foreignObject><text x="220" y="284" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0924</text>
</switch>
</g><path d="M 280 240 L 280 240 L 400 240 L 400 240" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 240 L 280 320 L 400 320 L 400 240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 240 L 400 240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="320" y="270" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 280px; margin-left: 321px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0503
</div>
</div>
</div>
</foreignObject><text x="340" y="284" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0503</text>
</switch>
</g><path d="M 110 280 L 196.72 135.46" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 199.42 130.96 L 198.82 138.76 L 196.72 135.46 L 192.82 135.16 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 110 125 L 195.11 195.92" fill="none" stroke="#ff0000" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 199.14 199.28 L 191.52 197.49 L 195.11 195.92 L 196 192.11 Z" fill-opacity="0.3" fill="#ff0000" stroke="#ff0000" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 110 280 L 194.97 213.91" fill="none" stroke="#ff0000" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 199.12 210.69 L 195.74 217.75 L 194.97 213.91 L 191.44 212.22 Z" fill-opacity="0.3" fill="#ff0000" stroke="#ff0000" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 110 125 L 196.64 264.59" fill="none" stroke="#0000ff" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 199.41 269.05 L 192.75 264.95 L 196.64 264.59 L 198.69 261.26 Z" fill-opacity="0.3" fill="#0000ff" stroke="#0000ff" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="100" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 110px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
S
</div>
</div>
</div>
</foreignObject><text x="20" y="114" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">S</text>
</switch>
</g><rect x="0" y="190" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 200px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
H
</div>
</div>
</div>
</foreignObject><text x="20" y="204" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">H</text>
</switch>
</g><rect x="0" y="270" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 280px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
N
</div>
</div>
</div>
</foreignObject><text x="20" y="284" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">N</text>
</switch>
</g><path d="M 110 120 L 183.63 120" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 188.88 120 L 181.88 123.5 L 183.63 120 L 181.88 116.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 110 200 L 185.21 134.19" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 189.16 130.74 L 186.2 137.98 L 185.21 134.19 L 181.59 132.71 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 110 200 L 185.5 275.5" fill="none" stroke="#0000ff" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 189.21 279.21 L 181.78 276.73 L 185.5 275.5 L 186.73 271.78 Z" fill-opacity="0.3" fill="#0000ff" stroke="#0000ff" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 110 280 L 183.68 289.21" fill="none" stroke="#0000ff" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 188.89 289.86 L 181.51 292.47 L 183.68 289.21 L 182.38 285.52 Z" fill-opacity="0.3" fill="#0000ff" stroke="#0000ff" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 195 L 305.33 134.33" fill="none" stroke="#66cc00" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 309.18 130.76 L 306.43 138.09 L 305.33 134.33 L 301.67 132.96 Z" fill-opacity="0.3" fill="#66cc00" stroke="#66cc00" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 285 L 316.92 145.58" fill="none" stroke="#66cc00" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/><path d="M 319.46 140.98 L 319.14 148.8 L 316.92 145.58 L 313.01 145.42 Z" fill-opacity="0.3" fill="#66cc00" stroke="#66cc00" stroke-opacity="0.3" stroke-miterlimit="10" pointer-events="none"/></g>
<switch>
<g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a>
</switch>
</svg>
<p><span class="math display">\[
P(\pi_{2}=S \textrm{ and } x_2 = 0 )= 0.9\cdot (0.06\cdot 0.5 + 0.27\cdot 0.4+0.03\cdot0.3)=0.1323
\]</span>
Finally, what is the probability of the following sequence: 1, 0, 0?
This is equal to the sum of all the probabilities at the end time:
<span class="math display">\[
P(x= \textrm{1 0 0})= 0.0874 + 0.0064 + 0.0503= 0.1441
\]</span>
Additional note: How do you find the probability of, for example, being at state S at time 3?
This is just the likelihood probability from the matrix divided by the sum of the entire column (what we calculated above):
<span class="math display">\[
\frac{0.0874} {0.0874 + 0.0064 + 0.0503}=0.6065
\]</span></p>
</div>
<div id="decoding-viterbi-algorithm" class="section level2">
<h2>Decoding: Viterbi Algorithm</h2>
<p>The <strong>viterbi algorithm</strong> attempts to answer: Given a sequence of observations, what is the most likely corresponding state path? It also uses <strong>dynamic programming</strong> by going from the first observation to the current observation and finding the most likely path, a.k.a the <strong>max</strong>. To find the path, we must also use <strong>backtracking</strong>.</p>
<p><span class="math display">\[
P (\pi = \pi_1,\pi_2, ...k \textrm{ and } x = x_1, x_2 , x_3 , ...x_t) = v_t (k)
\]</span>
As you can see from the formula, it is very similar to forward except we use the <strong>max</strong> instead of the <strong>sum</strong> of previous probabilities.</p>
<p><span class="math display">\[
v_t (k) = \max (v_{t-1}(l)\cdot\textrm{emission probability of }x_t \textrm{ given state } k\cdot\textrm{transition probability from l to k})
\]</span>
<span class="math display">\[
v_t (k) = \max (v_{t-1}(l)\cdot P (x_{t}|\pi_{t})\cdot P(\pi_{t}|\pi_{t-1}))
\]</span></p>
<p>Again, similar to the forward algorithm, you will need a matrix to store intermediate maximum values. Each value represents the probability of being at state <span class="math inline">\(k\)</span> at time <span class="math inline">\(t\)</span> given the observations until time <span class="math inline">\(t\)</span> and having gone through the most probable path at time <span class="math inline">\(t-1\)</span>. To compute this, you recursively find the most probable paths to each cell.</p>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="539px" viewBox="-0.5 -0.5 539 352" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2020-07-07T16:45:58.747Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36&quot; etag=&quot;5-2SwuO5O3Gh21Fzdcor&quot; version=&quot;13.3.9&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;oMR4MIIZOaCO1FRYHQ6a&quot; name=&quot;Page-1&quot;&gt;7VdNb+IwEP01ObZK7EDhWKC0qlQJicN+3KzYJFadGDmGhP31OybOhxMqikq32tVyQOMXe2Y878WeeHielo+KbJMXSZnwkE9LDy88hKbhGP4NcKiAUTCpgFhxWkFBC6z5L2ZB36I7TlnuTNRSCs23LhjJLGORdjCilCzcaRsp3KhbErMBsI6IGKLfONVJhU5Gfos/MR4ndeTAt09SUk+2QJ4QKosOhB88PFdS6spKyzkTpnZ1Xap1yzeeNokplun3LHj+WSxeN+XeL6JSkPX+eea/3NTJ7YnY2R3bbPWhLgEkvjWmVB6eFQnXbL0lkUEKoBywRKcCRgGYSmqiucxgeDP1AbDumdKsfDPxoCkHyIjJlGl1gCl2AcaT27tRtapWUYsULSsoRLcWTTqchKHdJLFaiJsQbbnAsBW7pHrB+eqxjN4bHcIoEiTPeeRWjJVcfwfbt/aPjr0ou4NDZ7BiisMemLJYFZbRgZh7RYbU5E5F7Kwkhmx0Cl2rv1vlGlNMgAL2bh6nKm8jrCSHDBuyw/r9sUyjaY+8Kn+7qiv3niMUuo4C1HOkiYqZHjg6CqHZ9ge0gT6ujfey+lVk9WvckHcpWXfojKPPJgtfRFYmMwBnlOQJo5arDm0GXxENb2d2RJCPAc21kq/NJYIaZC6FOVkhBPbht1z+hcQH4ysRP3D02cSHX0H8yTMfrq5LT/2BgJZLI6H/98EpR2PX0eQPC200EFoJw6MFjWqcknIgPGiZtCswl3Crxg0XogcRwWMjwQjYNmqZmQaMQ1d7bx+knFIT5mQ/p+Quo0d9X6mDC/vHe93ddzQ0OaGh/pV9vcZtPGDDpPZPkxBMe0ftaEhCeB0SYNh+11RvUPtxiB9+Aw==&lt;/diagram&gt;&lt;/mxfile&gt;" onclick="(function(svg){var src=window.event.target||window.event.srcElement;while (src!=null&amp;&amp;src.nodeName.toLowerCase()!='a'){src=src.parentNode;}if(src==null){if(svg.wnd!=null&amp;&amp;!svg.wnd.closed){svg.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&amp;&amp;evt.source==svg.wnd){svg.wnd.postMessage(decodeURIComponent(svg.getAttribute('content')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);svg.wnd=window.open('https://app.diagrams.net/?client=1&amp;lightbox=1&amp;edit=_blank');}}})(this);" style="cursor:pointer;max-width:100%;max-height:352px;">
<defs/><g><path d="M 148.75 -20.25 Q 391.25 -20.25 391.25 199.75 Q 391.25 419.75 148.75 419.75 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" transform="rotate(-90,270,199.75)" pointer-events="all"/><path d="M 50 321 L 50 47.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 50 42.12 L 53.5 49.12 L 50 47.37 L 46.5 49.12 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 50 321 L 523.63 321" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 528.88 321 L 521.88 324.5 L 523.63 321 L 521.88 317.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 50 81 L 530 81" fill="none" stroke="#0000ff" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="2 6" pointer-events="stroke"/><path d="M 270 321 L 270 1" fill="none" stroke="#ff0000" stroke-width="2" stroke-miterlimit="10" stroke-dasharray="2 6" pointer-events="stroke"/><rect x="230" y="331" width="80" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 341px; margin-left: 231px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
x = argmax
</div>
</div>
</div>
</foreignObject><text x="270" y="345" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">x = argmax</text>
</switch>
</g><rect x="0" y="71" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 81px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">
y=max
</div>
</div>
</div>
</foreignObject><text x="20" y="85" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">y=max</text>
</switch>
</g></g>
<switch>
<g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a>
</switch>
</svg>
<p>But what about the actual path? This is when we use backtracking and <strong>argmax</strong> instead of max. You need a separate matrix to keep track of these values. If you have a typical hyperbola, at the highest point, the y-value you obtain is the max, while the x-value in which you used as input into the function to obtain the highest point is the argmax. For example, if the max from before was from a hidden state of “S”, this value would be recorded in the backtracking matrix.</p>
<p><span class="math display">\[
\pi_t (k) = \textrm{argmax} (v_{t-1}(l)\cdot P (x_{t}|\pi_{t})\cdot P(\pi_{t}|\pi_{t-1}))
\]</span></p>
<pre class="python"><code>def viterbi(): 
  # if Stressed = 0, Relaxed = 1
  observations = [1, 0, 0, 1, 1, 0, 1, 1]
  #build empty dynamic programming matrix 
  num_states= 3
  obs_seq_num = len (observations)
  grid = []
  backtracking=[]
  for j in range(num_states):  
    grid.append(obs_seq_num * [0])
    backtracking.append(obs_seq_num * [0])
        
  # initial probability distribution for S, H, N
  initial = [0.6,0.3,0.1]
  
  # emission probability 
  emission= [[0.9,0.1],[0.1,0.9],[0.7,0.3]]
        
  #transition probabilities 
  transition = [[0.5,0.4,0.1],[0.4,0.2,0.4],[0.3,0.1,0.6]]



  for t in range(obs_seq_num):
    for i in range(num_states):
      #first column 
      if t == 0: 
        # use the initial probability distribution 
        grid[i][t] = initial[i] * emission [i][observations[t]]
      else: 
        Option_S=grid[0][t-1]*transition[0][i]
        Option_H=grid[1][t-1]*transition[1][i]
        Option_N=grid[2][t-1]*transition[2][i]
        grid[i][t] = emission [i][observations[t]] * max (Option_S, Option_H, Option_N)
        if Option_S&gt;Option_H and Option_S&gt;Option_N: 
          backtracking[i][t]=&quot;S&quot;
        elif Option_H&gt; Option_N and Option_H&gt;Option_S: 
          backtracking[i][t]=&quot;H&quot;
        else: 
          backtracking[i][t]=&quot;N&quot;
        
  prettyPrint (grid)
  
  print(&quot;Backtracking matrix&quot;)
  for w in backtracking: 
    print(w)
  
  #termination 
  if grid[0][-1]&gt; grid[1][-1] and grid[0][-1]&gt;grid[2][-1]:
    path=&quot;S&quot;
    pointer=0
  elif grid[1][-1]&gt;grid[0][-1] and grid[1][-1]&gt;grid[2][-1]: 
    path=&quot;H&quot;
    pointer=1
  else: 
    path=&quot;N&quot;
    pointer=2
  for s in range((obs_seq_num-1),0, -1):
    hidden_state=backtracking[pointer][s]
    path=hidden_state+&quot; &quot;+path
    if hidden_state==&quot;S&quot;:
      pointer=0
    elif hidden_state==&quot;H&quot;: 
      pointer=1
    else: 
      pointer=2

    
  print (&quot;Most likely state path: &quot; + path)
  
viterbi()</code></pre>
<pre><code>##          0          1          2          3          4          5          6          7 
## S  0.0600000  0.0972000  0.0437400  0.0021870  0.0006299  0.0010204  0.0000510  0.0000147  
## H  0.2700000  0.0054000  0.0038880  0.0157464  0.0028344  0.0000567  0.0003673  0.0000661  
## N  0.0300000  0.0756000  0.0317520  0.0057154  0.0018896  0.0007936  0.0001429  0.0000441  
## 
## Backtracking matrix
## [0, &#39;H&#39;, &#39;S&#39;, &#39;S&#39;, &#39;H&#39;, &#39;H&#39;, &#39;S&#39;, &#39;H&#39;]
## [0, &#39;H&#39;, &#39;S&#39;, &#39;S&#39;, &#39;H&#39;, &#39;H&#39;, &#39;S&#39;, &#39;H&#39;]
## [0, &#39;H&#39;, &#39;N&#39;, &#39;N&#39;, &#39;H&#39;, &#39;H&#39;, &#39;N&#39;, &#39;H&#39;]
## Most likely state path: H S S H H S H H</code></pre>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="403px" viewBox="-0.5 -0.5 403 324" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2020-07-07T21:52:17.644Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36&quot; etag=&quot;n69mDG4RgMj9XC624l1T&quot; version=&quot;13.3.9&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;AHcoFEZCvdGWv9FQ2CJZ&quot; name=&quot;Page-1&quot;&gt;7Vvfc5s4EP5r/HgZfhhjPzYkaR/am9557i59VEExagVyhRzb/etPAskYhDEQE2I7GU9GWiQB++2udj/LI9uLNh8pWIZfSADxyDKCzci+G1nWbDzh/4Vgmwkcc5oJFhQFmcjMBXP0G0qhIaUrFMCkMJARghlaFoU+iWPos4IMUErWxWFPBBfvugQLqAnmPsC69D8UsDCTTh0jl3+CaBGqO5uGvBIBNVgKkhAEZL0nsu9HtkcJYVkr2ngQC90pvWTzHg5c3T0YhTFrMmEB4WzqIRb9g/8CP8C3x1/b8A+5yjPAK/nC/yIG6XfEhV8Ao2gjH55tlUb4eyxFk4HvQnTrhwgHn8GWrJiSqt4t1/9nFKf4GWIowaso3pckDFAmUR8LQcgizNsmb65D/ijzJfDFxTW3rmwFDJYJSm+drkChv6IJeoZ/wyRbR0jhZgniQHaWBMX8pe6fuabUjZ9IzObypcTNAEaLmLd9KIaKJ1NwiatSS5AyuDmofnMHKncGSCLI6JYPkROsqbQD6Qiu7K5zqxor2wn3LMpW9gMShaNaOgebNyTeLbC3NOx1rNcowiAWMIeEot9caQDvazV9JueWf/hTesaNM3L4PI/3zbzPP2I4ZR6JE0YBSjUGQcLWMGFvxwqagHzYi3TktwrWZkibZl9I2xrSDEWQS9KOYdbhLgMryHU9GFrdAbJqXbMCINN6VYDGGkDGjTHRYOHvzYr65u5EfkKPYMJj1l1MUsieEMYlkRbehBYR3+Y+yAsRCoI0nFchSMkqDqCCpn1kPGyUBzGxG0RLHaHeYqWjAVQbLK/AaczJ4F4zOb6BwTj4ILJAYfoYJAnyi6oXG4BylRE3uvRP8yt+ZTLxPCPXJwy0tPGINp1qbe5pz6lQnpJRiAHj2Bfz2wqFyjt8FZaQg1XKPaYlRBKyoj6Uc/ZTyNIyplO/DrfxBWTaOim4u3fujrdbFSVnro76RcXJA4ZT2rveSJycahDZVx4nd04yXJycVfnN2NWRuSi/mZ6T3yjsr7kY6w51ff2127WOFWDl7ex06Oo0S/eoeCaQGNWYtCy5+oNEZz+MG8u97JBo1lNUpZrLHjom6rTFlXtN45qrP7epZCoMZ3zhjlNPVozfmOPobMWVO07jJLw/x9HJCuE49uzCHadV9Tq44+gMgwZPV0YJbhB7lGNE+5tQNE/Js97dZucjvLNVnZi/1eN+J5vlOqqfz0t7aqJGX4mHeHh4AX2lCpSMKmqQWGVc0NGtZChGzCxRYpOSTTWlxMpJU7mI75kSM3XCpS7Uv9eNLerG6nBUYZKz3uKRztxc/EbejLY5to/3Bom6WXEfv3AqLbPDc6kbrStkW+q9pnHd2J/bVNEthutc+HfcR84EvbH017pCwqXecRrXjf05TiXhYqu872Id56wIF0vP0+bngE/742/tzjiaQ3+tZuvZ2qd3YKy83B0MGD1H+/MdGB7JKg+LviYwDXKAYxRYF6rrRYyVOsDajJsainIaT0pOWE4amnJOY7e0kFFaqGfSydZzktY2ckqa9N12utuO7byy7Zzg0Obhw5mntKofq2gpa5nJaU3JHdKSnBJb0/kwqDM7kFO8liWd4Mua9pbU1AwGg9cqomJ2DRRleHeZyYvh5d38V2/Z8Pyng/b9/w==&lt;/diagram&gt;&lt;/mxfile&gt;" onclick="(function(svg){var src=window.event.target||window.event.srcElement;while (src!=null&amp;&amp;src.nodeName.toLowerCase()!='a'){src=src.parentNode;}if(src==null){if(svg.wnd!=null&amp;&amp;!svg.wnd.closed){svg.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&amp;&amp;evt.source==svg.wnd){svg.wnd.postMessage(decodeURIComponent(svg.getAttribute('content')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);svg.wnd=window.open('https://app.diagrams.net/?client=1&amp;lightbox=1&amp;edit=_blank');}}})(this);" style="cursor:pointer;max-width:100%;max-height:324px;">
<defs/><g><path d="M 0 40 L 0 0 L 400 0 L 400 40" fill="#000000" stroke="#000000" stroke-miterlimit="10" transform="translate(2,3)" opacity="0.25"/><path d="M 0 40 L 0 0 L 400 0 L 400 40" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 0 40 L 0 320 L 400 320 L 400 40" fill="none" stroke="#000000" stroke-miterlimit="10" transform="translate(2,3)" opacity="0.25"/><path d="M 0 40 L 0 320 L 400 320 L 400 40" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 0 40 L 400 40" fill="none" stroke="#000000" stroke-miterlimit="10" transform="translate(2,3)" opacity="0.25"/><path d="M 0 40 L 400 40" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 398px; height: 1px; padding-top: 20px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
Viterbi Matrix
</div>
</div>
</div>
</foreignObject><text x="200" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Viterbi Matrix</text>
</switch>
</g><path d="M 40 40 L 0 40 L 0 150 L 40 150" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 40 L 400 40 L 400 150 L 40 150" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 40 L 40 150" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 80 L 40 40 L 160 40 L 160 80" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 80 L 40 150 L 160 150 L 160 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 80 L 160 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 60px; margin-left: 41px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
time = 1
</div>
</div>
</div>
</foreignObject><text x="100" y="64" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">time = 1</text>
</switch>
</g><rect x="70" y="110" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 71px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.06
</div>
</div>
</div>
</foreignObject><text x="90" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.06</text>
</switch>
</g><path d="M 160 80 L 160 40 L 280 40 L 280 80" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 80 L 160 150 L 280 150 L 280 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 80 L 280 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 60px; margin-left: 161px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
2
</div>
</div>
</div>
</foreignObject><text x="220" y="64" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">2</text>
</switch>
</g><path d="M 240 120 L 303.63 120" fill="none" stroke="#66cc00" stroke-miterlimit="10" pointer-events="none"/><path d="M 308.88 120 L 301.88 123.5 L 303.63 120 L 301.88 116.5 Z" fill="#66cc00" stroke="#66cc00" stroke-miterlimit="10" pointer-events="none"/><rect x="200" y="110" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 201px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0972
</div>
</div>
</div>
</foreignObject><text x="220" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0972</text>
</switch>
</g><path d="M 280 80 L 280 40 L 400 40 L 400 80" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 80 L 280 150 L 400 150 L 400 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 80 L 400 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 60px; margin-left: 281px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
3
</div>
</div>
</div>
</foreignObject><text x="340" y="64" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">3</text>
</switch>
</g><rect x="320" y="110" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 120px; margin-left: 321px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0473
</div>
</div>
</div>
</foreignObject><text x="340" y="124" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0473</text>
</switch>
</g><path d="M 40 150 L 0 150 L 0 230 L 40 230" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 150 L 400 150 L 400 230 L 40 230" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 150 L 40 230" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 150 L 40 150 L 160 150 L 160 150" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 150 L 40 230 L 160 230 L 160 150" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 150 L 160 150" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="70" y="180" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 190px; margin-left: 71px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.27
</div>
</div>
</div>
</foreignObject><text x="90" y="194" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.27</text>
</switch>
</g><path d="M 160 150 L 160 150 L 280 150 L 280 150" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 150 L 160 230 L 280 230 L 280 150" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 150 L 280 150" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="200" y="180" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 190px; margin-left: 201px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0054
</div>
</div>
</div>
</foreignObject><text x="220" y="194" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0054</text>
</switch>
</g><path d="M 280 150 L 280 150 L 400 150 L 400 150" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 150 L 280 230 L 400 230 L 400 150" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 150 L 400 150" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="320" y="180" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 190px; margin-left: 321px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0039
</div>
</div>
</div>
</foreignObject><text x="340" y="194" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0039</text>
</switch>
</g><path d="M 110 190 L 193.64 194.65" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="none"/><path d="M 198.88 194.94 L 191.7 198.04 L 193.64 194.65 L 192.09 191.06 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 230 L 0 230 L 0 320 L 40 320" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 230 L 400 230 L 400 320 L 40 320" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 230 L 40 320" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 230 L 40 230 L 160 230 L 160 230" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 230 L 40 320 L 160 320 L 160 230" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 40 230 L 160 230" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="70" y="260" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 270px; margin-left: 71px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.03
</div>
</div>
</div>
</foreignObject><text x="90" y="274" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.03</text>
</switch>
</g><path d="M 160 230 L 160 230 L 280 230 L 280 230" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 230 L 160 320 L 280 320 L 280 230" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 160 230 L 280 230" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="200" y="260" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 270px; margin-left: 201px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0756
</div>
</div>
</div>
</foreignObject><text x="220" y="274" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0756</text>
</switch>
</g><path d="M 280 230 L 280 230 L 400 230 L 400 230" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 230 L 280 320 L 400 320 L 400 230" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 280 230 L 400 230" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="320" y="260" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 270px; margin-left: 321px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">
0.0318
</div>
</div>
</div>
</foreignObject><text x="340" y="274" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.0318</text>
</switch>
</g><rect x="0" y="100" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 110px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
S
</div>
</div>
</div>
</foreignObject><text x="20" y="114" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">S</text>
</switch>
</g><rect x="0" y="190" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 200px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
H
</div>
</div>
</div>
</foreignObject><text x="20" y="204" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">H</text>
</switch>
</g><rect x="0" y="270" width="40" height="20" fill="none" stroke="none" transform="translate(2,3)" opacity="0.25"/><g transform="translate(-0.5 -0.5)">
<switch>
<foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
<div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 280px; margin-left: 1px;">
<div style="box-sizing: border-box; font-size: 0; text-align: center; ">
<div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: normal; word-wrap: normal; ">
N
</div>
</div>
</div>
</foreignObject><text x="20" y="284" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">N</text>
</switch>
</g><path d="M 110 190 L 184.91 133.82" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="none"/><path d="M 189.11 130.67 L 185.61 137.67 L 184.91 133.82 L 181.41 132.07 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="none"/><path d="M 110 190 L 185.77 275.24" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="none"/><path d="M 189.26 279.16 L 181.99 276.26 L 185.77 275.24 L 187.22 271.61 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 120 L 305.5 185.5" fill="none" stroke="#66cc00" stroke-miterlimit="10" pointer-events="none"/><path d="M 309.21 189.21 L 301.78 186.73 L 305.5 185.5 L 306.73 181.78 Z" fill="#66cc00" stroke="#66cc00" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 120 L 307.31 264.23" fill="none" stroke="#66cc00" stroke-miterlimit="10" pointer-events="none"/><path d="M 309.53 268.99 L 303.4 264.12 L 307.31 264.23 L 309.74 261.16 Z" fill="#66cc00" stroke="#66cc00" stroke-miterlimit="10" pointer-events="none"/></g>
<switch>
<g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a>
</switch>
</svg>
<p>For example, how did they calculate the probability of the most probable path at time 2 if the last state is S? The maximum of the time <span class="math inline">\(t-1\)</span> is if the sequence started with H.</p>
<p><span class="math display">\[
P (\pi = \pi_1, ...S \textrm{ and } x = x_1, ...0)= 0.27 \cdot 0.4 \cdot 0.9=0.0972
\]</span>
The highest probability in the very last column of the 1st matrix gives us the probability of the most probable path. Therefore, the probability of the most probable path of 1, 0, 0, 1, 1, 0, 1, 1: 6.611976345600003e-05.</p>
<p>To find the path, go to last column and find the state with the highest probability, that is the last hidden state: <em>? ? ? ? ? ? ? H</em>. Then using the backtracking matrix constructed from the argmax, work backwards. In this case, since the last hidden state was H, go to the last column in the backtracking matrix and the row for H (the middle), which also has an H: <em>? ? ? ? ? ? H H</em> Therefore, go to the second to last column and again the row for H, this has the value S: <em>? ? ? ? ? S H H</em>. Then go to the third to last column, row for S …. And so on… Finally: <em>H S S H H S H H</em>.</p>
</div>
<div id="packages" class="section level2">
<h2>Packages</h2>
<p>This is too much math/I don’t care. There are plenty of packages available on the internet, for example, these methods are implemented in the R package, HMM, which I think is super helpful. Just understanding what the different terms mean such as transition matrix, initial probability distribution, emission probability, etc. should be enough to use these tools.</p>
</div>
<div id="application" class="section level2">
<h2>Application</h2>
<p><a href="https://www.kaggle.com/alfrandom/protein-secondary-structure/data">This</a> is a good exercise to test your understanding. It looks at predicting the secondary structure of proteins from the primary sequence. Another common application in bioinformatics is detecting CpG islands.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ol style="list-style-type: decimal">
<li><a href="https://www.cs.rochester.edu/u/james/CSC248/Lec11.pdf" class="uri">https://www.cs.rochester.edu/u/james/CSC248/Lec11.pdf</a></li>
<li><a href="http://pages.cs.wisc.edu/~matthewb/pages/notes/pdf/hmms/ForwardAlgorithm.pdf" class="uri">http://pages.cs.wisc.edu/~matthewb/pages/notes/pdf/hmms/ForwardAlgorithm.pdf</a></li>
<li><a href="https://web.stanford.edu/~jurafsky/slp3/A.pdf" class="uri">https://web.stanford.edu/~jurafsky/slp3/A.pdf</a></li>
<li><a href="https://www.cis.upenn.edu/~cis262/notes/Example-Viterbi-DNA.pdf" class="uri">https://www.cis.upenn.edu/~cis262/notes/Example-Viterbi-DNA.pdf</a></li>
</ol>
</div>
</div>
