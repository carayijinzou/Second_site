---
title: "Hidden Markov Model"
author: "Cara Yijin Zou"
date: "2020-04-20"
output: html_document
math : true
categories: ["Statistics", "Probability","Bioinformatics"]
tags: ["Statistics","Modelling", "Markov Chain","Probability","HMM","Forward Algorithm","Viterbi Algorithm", "Emission probability","Observed State","R"]
draft: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Hidden Markov Model
I go over the basics of a Markov Chain [here](../Markov_chain), however, unlike chutes and ladders, for a hidden markov model, there is hidden information. In this case the markov chain is not visible to us, we can only observe outcome values. 

Like a markov chain, there are still **states** (now hidden), **transition probabilities**, and **initial probabilities**. However, in addition to this, we also have an **observed state** and an **emission probability**.

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="751px" viewBox="-0.5 -0.5 751 441" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2020-07-02T17:47:17.085Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36&quot; etag=&quot;IwPpH-5e6uUfPe3D6aqo&quot; version=&quot;13.3.5&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;C5RBs43oDa-KdzZeNtuy&quot; name=&quot;Page-1&quot;&gt;7Vxbk5pIFP41PsaiLyA+RjMz2c1uNrtmd3aeUkRapQZtt8FR8+u3GRqB7lbQEdBgpSpFX2joc/nOdw7tdNBwvnlgznL2O3WJ34GGu+mgDx0I+9ji/0cd27jDBHbcMWWeG3eBtGPk/SCi0xC9K88lQW5iSKkfest855guFmQc5vocxug6P21C/fxTl86UKB2jseOrvY+eG87iXhv20v6PxJvOkicDqx+PzJ1ksthJMHNcus50obsOGjJKw/hqvhkSP5JdIpfHX7aP/m/P1sOvfwb/OX8PPn39/M+7eLH7Y27ZbYGRRXjepYUUXhx/JeT1mYQT39uILYfbRI6MrhYuidYCHTRYz7yQjJbOOBpdc8PhfbNw7ovhCV2EwhQAl9Ng6jtBpEeDXwcho887XUSzd4KNhiee7w+pT9nrY9Hg9R/vLykDIasXwkKyyViAkMkDoXMSsi2fIkZxX6hX2DfEor1OrQUkJjDLWEoyzxEGOt0tnSqBXwg9HKNuoChl5BOybI1KwOWpBCoq+ciXXlP23BqtIJzXCurVqBUU3OHFwJzNBi8j9unr9psz+UPgXVYpijLIwn0fBRHeGkei9cZ5+XMZse2/kUS7ZtJ8yo592Ahxx61t0tp4YeY23nrKjKQ3RY3knvjliKvEq3KaCuiKjUkJIw0dNiWHFuzp9ZzRo6lRY9LHiO+E3kt+Ezrdiid8oR7fXmpGknMjUzKPeJ/irmw8kxbCsj0a0kKxHJSFXk1tt+3TrU9FaaOLFQPkzhXmTS5268RzF3RBJGcWXY7vTReR3XLrILx/ELmqx4nNezEw91w3eowWY1IUSk1P8fWyxrc/eO7TQcaWsMaWYFWQoOJ0bZDwRvcu9FqwRxX1uC029qD/tbkturktRPDC3BYXu+14xV52rKrIh9/ki025mIn20N5jXczsSQuhci7GRepsM9OW0YTgwAsD6TnAOPxe0gaBXTDfOnK+Lb2PkZvPL+IdnhVPTA2emC3DEyjhCTAbxhPrDDRAMPzk+inH9vUMP6UOWeKQ4RHVUIfizKAsx7hlBueABLWoZnQTVbUFElAP57FYUy2oFRLsG8VQgfpkigGteigGNI6jGEokKqAMO8GWnS9TqzooRv980czowmzBCpQMZ+KuXUS7lngWl8QaC2gSH0XgRG9DkpUiq96Apil/ty9pliEPoYYjGtCVMqyWaUXJKZtOPUCJWsYRJUg7j7zvjK5RlE28tr4Q5vENRWqrpzrZKNIqmb+NTkNaU+YbcpmzaqTVlRPaljvISmgeaUvUE37+5AHZZk4t+FQ6gyXMxrLizpQ8IImsJ3WBvTRL3mDv8HwMj5yPD75PNckD0FUjVPP9uRFFLi1hu2lEKVGOKJ3T5SqUsGSJEnRyJUrYdI2yV5ZoNIuBco2yfyoGyjVKuRJTNdFQiwpGF7UNFmTaCBuGhWTh7NG/kJEg4KKQVcNmdP59FewRYPaMWf6gWL8/HN7fVynV4ozM1gjVrkyo6kmdvzgKbK5YplATv+qVqVoRqid+5eGnE33bMYyM6OstOh5w4kuJUAq5PjlC1ZwKQ7W8dbyJ6dlOUQFFa5i96zfMRqkTKGI8ZQ1TOR4uc7CqDVOtBlxfkO4Zlxal1Tz16qK0LNTmw/QZ0szKgK0Yr6wm8cqST7fJH93K4pUlfyuX62ZV49UZvh/vNwL9OamCYLnnoNTllSAOQNWN4L31JLaa7FZgl0YX9GH2yEPXKCqR8caZP5+V/O3O1ZsUkgKgWTPUITXVr8SkbNPOm9TNoiqyKPlbYO0WpWah10f25aMrOyE2xUuRekji6sg+vjihqmT/cs8OUD7ohZHozCor/LsfJEvnNRur8CPdd5d+y5UkV7f7DSsJq8z0cj+O1aQkS8oWoAbu6lWS7gfYvZYr6eI8Cd7gTmFjMjdu+sgq1h0kbjlxwHZtSuLN9I9IxXlL+pe40N3/&lt;/diagram&gt;&lt;/mxfile&gt;" onclick="(function(svg){var src=window.event.target||window.event.srcElement;while (src!=null&amp;&amp;src.nodeName.toLowerCase()!='a'){src=src.parentNode;}if(src==null){if(svg.wnd!=null&amp;&amp;!svg.wnd.closed){svg.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&amp;&amp;evt.source==svg.wnd){svg.wnd.postMessage(decodeURIComponent(svg.getAttribute('content')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);svg.wnd=window.open('https://app.diagrams.net/?client=1&amp;lightbox=1&amp;edit=_blank');}}})(this);" style="cursor:pointer;max-width:100%;max-height:441px;"><defs/><g><rect x="460" y="90" width="120" height="40" rx="6" ry="6" fill="#b3b3b3" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 110px; margin-left: 461px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Netflix</div></div></div></foreignObject><text x="520" y="114" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Netflix</text></switch></g><rect x="160" y="90" width="120" height="40" rx="6" ry="6" fill="#b3b3b3" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 110px; margin-left: 161px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Sleep</div></div></div></foreignObject><text x="220" y="114" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Sleep</text></switch></g><rect x="310" y="220" width="120" height="40" rx="6" ry="6" fill="#b3b3b3" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 240px; margin-left: 311px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Homework</div></div></div></foreignObject><text x="370" y="244" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Homework</text></switch></g><path d="M 370 220 L 514.54 133.28" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 519.04 130.58 L 514.84 137.18 L 514.54 133.28 L 511.24 131.18 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="410" y="150" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 160px; margin-left: 411px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.4</div></div></div></foreignObject><text x="430" y="164" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.4</text></switch></g><path d="M 370 220 L 225.46 133.28" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 220.96 130.58 L 228.76 131.18 L 225.46 133.28 L 225.16 137.18 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="290" y="150" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 160px; margin-left: 291px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.4</div></div></div></foreignObject><text x="310" y="164" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.4</text></switch></g><path d="M 500 90 Q 480 60 490 45 Q 500 30 515 30 Q 530 30 540 40 Q 550 50 542.01 73.96" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 540.35 78.94 L 539.25 71.19 L 542.01 73.96 L 545.89 73.41 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="190" y="0" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 10px; margin-left: 191px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.5</div></div></div></foreignObject><text x="210" y="14" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.5</text></switch></g><path d="M 280 110 L 453.63 110" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 458.88 110 L 451.88 113.5 L 453.63 110 L 451.88 106.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="344" y="120" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 130px; margin-left: 345px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.1</div></div></div></foreignObject><text x="364" y="134" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.1</text></switch></g><path d="M 190 90 Q 170 60 180 45 Q 190 30 205 30 Q 220 30 230 40 Q 240 50 232.01 73.96" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 230.35 78.94 L 229.25 71.19 L 232.01 73.96 L 235.89 73.41 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 190 130 L 334.54 216.72" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 339.04 219.42 L 331.24 218.82 L 334.54 216.72 L 334.84 212.82 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="230" y="180" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 190px; margin-left: 231px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.4</div></div></div></foreignObject><text x="250" y="194" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.4</text></switch></g><rect x="500" y="0" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 10px; margin-left: 501px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.6</div></div></div></foreignObject><text x="520" y="14" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.6</text></switch></g><path d="M 550 133 L 414.45 214.71" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 409.96 217.42 L 414.15 210.81 L 414.45 214.71 L 417.76 216.81 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="470" y="180" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 190px; margin-left: 471px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.1</div></div></div></foreignObject><text x="490" y="194" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.1</text></switch></g><path d="M 355 260 Q 340 290 347.5 305 Q 355 320 375 320 Q 395 320 402.5 305 Q 410 290 402.85 275.7" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 400.5 271 L 406.76 275.7 L 402.85 275.7 L 400.5 278.83 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="360" y="330" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 340px; margin-left: 361px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.2</div></div></div></foreignObject><text x="380" y="344" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.2</text></switch></g><path d="M 460 100 L 286.37 100" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 281.12 100 L 288.12 96.5 L 286.37 100 L 288.12 103.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="350" y="70" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 80px; margin-left: 351px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.3</div></div></div></foreignObject><text x="370" y="84" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.3</text></switch></g><path d="M 40 0 L 80 40 L 40 80 L 0 40 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 40px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Stressed</div></div></div></foreignObject><text x="40" y="44" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Stressed</text></switch></g><path d="M 40 130 L 80 170 L 40 210 L 0 170 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 170px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Relaxed</div></div></div></foreignObject><text x="40" y="174" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Relaxed</text></switch></g><path d="M 160 100 L 72.36 56.18" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 67.67 53.83 L 75.49 53.83 L 72.36 56.18 L 72.36 60.09 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 160 120 L 66.1 148.17" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 61.07 149.68 L 66.77 144.31 L 66.1 148.17 L 68.78 151.02 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 710 0 L 750 40 L 710 80 L 670 40 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 40px; margin-left: 671px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Stressed</div></div></div></foreignObject><text x="710" y="44" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Stressed</text></switch></g><path d="M 710 130 L 750 170 L 710 210 L 670 170 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 170px; margin-left: 671px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Relaxed</div></div></div></foreignObject><text x="710" y="174" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Relaxed</text></switch></g><path d="M 580 110 L 678.39 57.02" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 683.02 54.53 L 678.51 60.93 L 678.39 57.02 L 675.19 54.77 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 580 120 L 683.86 148.32" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 688.92 149.71 L 681.25 151.24 L 683.86 148.32 L 683.09 144.49 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 333.04 261 L 273.42 354.63" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 270.6 359.06 L 271.41 351.27 L 273.42 354.63 L 277.31 355.03 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 412.96 262 L 466.8 354.5" fill="none" stroke="#0000ff" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 469.44 359.03 L 462.89 354.74 L 466.8 354.5 L 468.94 351.22 Z" fill="#0000ff" stroke="#0000ff" stroke-miterlimit="10" pointer-events="all"/><path d="M 270 360 L 310 400 L 270 440 L 230 400 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 400px; margin-left: 231px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Stressed</div></div></div></foreignObject><text x="270" y="404" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Stressed</text></switch></g><path d="M 470 360 L 510 400 L 470 440 L 430 400 Z" fill="#99ccff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 400px; margin-left: 431px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Relaxed</div></div></div></foreignObject><text x="470" y="404" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Relaxed</text></switch></g><rect x="90" y="50" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 60px; margin-left: 91px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.1</div></div></div></foreignObject><text x="110" y="64" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.1</text></switch></g><rect x="100" y="140" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 150px; margin-left: 101px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.9</div></div></div></foreignObject><text x="120" y="154" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.9</text></switch></g><rect x="610" y="60" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 70px; margin-left: 611px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.3</div></div></div></foreignObject><text x="630" y="74" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.3</text></switch></g><rect x="600" y="140" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 150px; margin-left: 601px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.7</div></div></div></foreignObject><text x="620" y="154" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.7</text></switch></g><rect x="260" y="300" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 310px; margin-left: 261px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.9</div></div></div></foreignObject><text x="280" y="314" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.9</text></switch></g><rect x="450" y="300" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 310px; margin-left: 451px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">0.1</div></div></div></foreignObject><text x="470" y="314" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">0.1</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>

## Emission probability
The **emission probability** is what gives way to the **observed state**. In other words, given the state $\pi$, what is the probability of the observed state $x$ happening at time $i$. 

$$
P (x_{i}|\pi_{i}) = \textrm{emission probability}
$$

Still using the example from before, the difference now is that you don't know if the student is sleeping, watching netflix, or doing homework. Instead, the only information you have is whether or not the student is stressed (observed state). Depending on your actual state (sleep, homework, netflix), the probability of being stressed changes. 

|                | Stressed         | Relaxed           | 
|----------------| -----------------| ------------------|
| **Sleep**      | 0.1              | 0.9               |
| **Homework**   | 0.9              | 0.1               |
| **Netflix**    | 0.3              | 0.7               | 

For reference, here is the **initial probabilities** from before:

| Outcome          | Likelihood                     |
| -----------------| -------------------------------|
| Sleep            | 0.6                            |
| Homework         | 0.3                            |
| Netflix          | 0.1                            |

As well as the **transition probabilities**: 

|                | Sleep            | Homework           | Netflix        |
|----------------| -----------------| -------------------|----------------|
| **Sleep**      | 0.5              | 0.4                | 0.1            |
| **Homework**   | 0.4              | 0.2                | 0.4            |
| **Netflix**    | 0.3              | 0.1                | 0.6            |


## Example 
| Observations $x$ (1= stressed, 0=relaxed)                     |  1  |  1  |  0  |  0  |  1  |  1  |  1  |  0  |  0  |
|---------------------------------------------------------------|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| **State Path** $\pi$ (S= sleep, H=homework, N=netflix)        |  H  |  H  |  N  |  N  |  N  |  H  |  S  |  S  |  S  |
| **Emission Probability**  $P (x_{i}|\pi_{i})$                 | 0.9 | 0.9 | 0.7 | 0.7 | 0.3 | 0.9 | 0.1 | 0.9 | 0.9 |
| **Transition Probability** $P (\pi_{i-1} \rightarrow \pi_{i})$| 0.3 | 0.2 | 0.4 | 0.6 | 0.6 | 0.1 | 0.4 | 0.5 | 0.5 |


## Brute Force
Before going into the algorithms, we could use brute force. We could potentially state all possible state paths given a particular observations. For example, if we observed: {1, 0, 0}, the possible state paths include SSS, SHH, SHN, SNN, SNH, HHH, HNS, HSH, HSS, etc. We could calculate the possibility of each, for example: SNS. Initial probability of sleep is 0.6. The probability of being stressed given that they are sleeping is 0.1. Sleep transitioning to Netflix is 0.1.Probability of being relaxed watching Netflix is 0.3. And so on...

$$
P (\pi_{1}=S) \cdot P(x_{1}=1|\pi_{1}=S)\cdot P (\pi_{1}=S \rightarrow \pi_{2}=N)\cdot P(x_{1}=0|\pi_{1}=N)\cdot P (\pi_{2}=N \rightarrow \pi_{3}=S)\cdot P(x_{3}=0|\pi_{3}=S)
$$

outcome likelihood probability= prob that an HMM emmits a given string (input is string of observation, output is probability)



$$
P (\pi=\{S,N,S\} \textrm{ and }x=\{1,0,0\})=0.6 \cdot0.1\cdot0.1\cdot0.3\cdot0.3\cdot0.9 = 0.000486
$$
To find the **total probability** of an observed sequence (e.g. 1,0,0), we need to **add** up all of the possible state path probabilities (SNS, SSS, HSN, etc.). Why don't we do this? Because it would take forever, instead, we use the viterbi algorithm. 

## Viterbi Algorithm
The **viterbi algorithm** attempts to answer: Given a sequence of observations, what is the most likely corresponding state path? It also uses **dynamic programming** and **recursion** by going from the first observation to the current observation and finding the most likely path, a.k.a the **max**. To achieve this, we must multiply from i through n. 



$$
P (x|\pi ) = \textrm{initial probability}\cdot \max(\prod(\textrm{transition probability*emission probability}))
$$


## Forward Algorithm
The **forward algorithm** attempts to answer: What is the probability of a certain state at each time given the observations? It uses **dynamic programming** and use the **sum**. Total product weight of all paths to 

$$
P (\pi_{i}=state | x) = \sum
$$



## HMM Package in R 
These methods are implemented in the R package, HMM, which I think is super helpful. 

## Application
[This](https://www.kaggle.com/alfrandom/protein-secondary-structure/data) is a good exercise to test your understanding. It looks at predicting the secondary structure of proteins from the primary sequence. 

