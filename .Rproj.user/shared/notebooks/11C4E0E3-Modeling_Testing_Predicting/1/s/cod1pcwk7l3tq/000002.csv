"0","#H0: The centroid and dispersion of points is the same for the different regions"
"0","#H1: The centroid and dispersion of points is different for at least one of the different regions"
"0",""
"0",""
"0","#compute distances/dissimilarities"
"0","dists<-TB_Data%>%dplyr::select(new.pul.TB,prev.treated.pul.TB,prev.unk.pul.TB, new.MDR, prev.MDR, XDR, pop.number, TB.100k, TB_mort.100k, GDP)%>%dist()"
"0",""
"0",""
"0","#compute observed F"
"0","SST<- sum(dists^2)/150"
"0","SSW<-TB_Data%>%group_by(region)%>%dplyr::select(new.pul.TB,prev.treated.pul.TB,prev.unk.pul.TB, new.MDR, prev.MDR, XDR, pop.number, TB.100k, TB_mort.100k, GDP)%>%"
"0"," do(d=dist(.[2:3],""euclidean""))%>%ungroup()%>%"
"0"," summarise(sum(d[[1]]^2)/50 + sum(d[[2]]^2)/50+ sum(d[[3]]^2)/50)%>%pull"
"0","F_obs<-((SST-SSW)/2)/(SSW/147) #observed F statistic"
"0","F_obs"
"1","[1]"
"1"," 21739142596"
"1","
"
"0","# compute null distribution for F"
"0","Fs<-replicate(1000,{"
"0","new<-TB_Data%>%mutate(region=sample(region)) #permute the region vector"
"0","SSW<-new%>%group_by(region)%>%dplyr::select(new.pul.TB,prev.treated.pul.TB,prev.unk.pul.TB, new.MDR, prev.MDR, XDR, pop.number, TB.100k, TB_mort.100k, GDP)%>%"
"0"," do(d=dist(.[2:3],""euclidean""))%>%ungroup()%>%"
"0"," summarise(sum(d[[1]]^2)/50 + sum(d[[2]]^2)/50+ sum(d[[3]]^2)/50)%>%pull"
"0","((SST-SSW)/2)/(SSW/147) #calculate new F on randomized data"
"0","})"
"0",""
"0","{hist(Fs,prob = T); abline(v=F_obs, col=""red"", add=T)}"
