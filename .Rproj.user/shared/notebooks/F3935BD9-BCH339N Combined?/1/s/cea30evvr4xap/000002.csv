"0","#Clinvar"
"0","CADD_clinvar = read.csv('Final_ClinVar_CADD.csv', header=T)"
"0","clinvar2$PHRED = CADD_clinvar$PHRED"
"0",""
"0","#Cancer variant"
"0","CADD_cancer = read.csv('Final_Cancer_CADD.csv', header = T)%>%mutate(Ref=as.character(REF))%>%mutate(Var=as.character(ALT))%>%rename(Start.Pos=POS)%>%select(-c(REF,ALT))"
"0","CADD_cancer<-CADD_cancer%>%mutate(Start.Pos=ifelse(nchar(Ref)>1, Start.Pos+1,Start.Pos))%>%mutate(Var=ifelse(nchar(Ref)>1,ifelse(substr(Var,2,nchar(Var))=="""",""-"",substr(Var,2,nchar(Var))),Var))%>%mutate(Ref=ifelse(nchar(Ref)>1,substr(Ref,2,nchar(Ref)),Ref))"
"0","cancer3<-left_join(cancer, CADD_cancer, by=c(""Start.Pos"",""Ref"",""Var""))%>%mutate(PHRED=ifelse(is.na(PHRED),max(PHRED,na.rm=T),PHRED))"
"2","Column `Ref` joining factor and character vector, coercing into character vector"
"2","Column `Var` joining factor and character vector, coercing into character vector"
"0","cancer2$PHRED <- cancer3$PHRED"
"0",""
"0","# gnomAD variant"
"0","CADD_gnomAD = read.csv('GnomAD_3_CADD.csv', header = T)"
"0","CADD_gnomAD<-CADD_gnomAD%>%rename(Reference=REF)%>%rename(Alternate=ALT)%>%rename(Position=POS)"
"0",""
"0",""
"0","gnomad_condensed<-gnomad%>%select(Position,Consequence,Transcript.Consequence,Annotation,rsID,Reference,Alternate)"
"0","gnomAD_CADD<-left_join(gnomad_condensed,CADD_gnomAD, by=c(""Position"",""Reference"",""Alternate""))"
"2","Column `Reference` joining factors with different levels, coercing to character vector"
"2","Column `Alternate` joining factors with different levels, coercing to character vector"
"0","#Get the average score based on Annotation"
"0","Avg_CADD_Gnomad<-gnomAD_CADD%>%group_by(Annotation)%>%summarize(avg=mean(PHRED, na.rm=T))"
"0","result = left_join(gnomAD_CADD,Avg_CADD_Gnomad)%>% mutate(PHRED=ifelse(is.na(PHRED),avg,PHRED))"
"2","Joining, by = ""Annotation""
"
"0","overlap_pathogenic = as.logical(-1*(overlap_clinvar + overlap_cancer - 1))"
"0","result = data.frame(result[overlap_pathogenic, ])"
"0","index = is.nan(result$PHRED)"
"0","index = result[as.logical(-1*index+1),]"
"0","average = mean(index$PHRED)"
"0","result = result %>% mutate(PHRED = ifelse(is.nan(PHRED), average, PHRED ))"
"0","gnomAD2$PHRED = result$PHRED"
"0",""
